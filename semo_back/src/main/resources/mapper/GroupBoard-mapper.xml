<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.or.semo.groupBoard.model.dao.GroupBoardDao">
	<select id="totalCount" resultType="int">
		select count(*) from gr_board where gr_board_state=1
	</select>
	
	<select id="selectgroupBoardList" resultType="groupBoard">
		SELECT * FROM
			(SELECT ROWNUM AS RNUM, B.*FROM
			(SELECT 
			    GR_BOARD_NO,
			    GR_BOARD_TITLE,
			    GR_BOARD_WRITER,
			    MEMBER_ID,
			    TO_CHAR(GR_BOARD_DATE, 'YYYY-MM-DD') AS GR_BOARD_DATE
			FROM GR_BOARD
			JOIN MEMBER ON (GR_BOARD_WRITER = MEMBER_NO)
			WHERE GR_BOARD_STATE = 1
			ORDER BY 1 DESC) B)
		WHERE RNUM BETWEEN #{start} AND #{end}
			
	</select>
	<insert id="insertGroupBoard">
		insert into gr_board values(gr_board_seq.nextval, #{grBoardTitle}, #{grBoardContent}, sysdate, #{grBoardWriter}, 13, 1)
		<selectKey resultType="int" keyProperty="grBoardNo" order="AFTER">
			select max(gr_board_no) from gr_board
		</selectKey>
	</insert>
	<select id="selectOneGroupBoard" resultType="groupBoard">
		select 
			gr_board_no, gr_board_title, gr_board_content, to_char(gr_board_date,'yyyy-mm-dd') as gr_board_date, gr_board_writer, member_name, group_no, gr_board_state
		from gr_board 
		join member on(gr_board_writer = member_no) 
		where gr_board_no = #{grBoardNo}
	</select>
	
</mapper>